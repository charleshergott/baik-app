<div class="itinerary-container">
    <div class="controls">
        <button class="control-btn start-btn" [class.recording]="isRecording" (click)="toggleRecording()"
            [disabled]="!gpsAvailable">
            {{ isRecording ? '‚èπÔ∏è Stop Recording' : '‚ñ∂Ô∏è Start Recording' }}
        </button>

        <button class="control-btn clear-btn" (click)="clearItinerary()" [disabled]="points.length === 0">
            üóëÔ∏è Clear
        </button>
    </div>

    <div class="current-data" *ngIf="currentPosition">
        <h3>Current Position</h3>
        <div class="data-grid">
            <div class="data-item">
                <span class="data-label">Speed</span>
                <span class="data-value">{{ formatSpeed(currentPosition.coords.speed) }}</span>
            </div>
            <div class="data-item">
                <span class="data-label">Altitude</span>
                <span class="data-value">{{ formatAltitude(currentPosition.coords.altitude) }}</span>
            </div>
            <!-- <div class="data-item">
                <span class="data-label">Accuracy</span>
                <span class="data-value">{{ currentPosition.coords.accuracy.toFixed(1) }}m</span>
            </div> -->
            <div class="stat-card">
                <h3>Total Distance</h3>
                <p class="stat-value">{{ formatTotalDistance() }}</p>
            </div>

            <div class="stat-card" *ngIf="isRecording">
                <h3>Trip Distance</h3>
                <p class="stat-value">{{ formatCurrentTripDistance() }}</p>
            </div>
        </div>
    </div>

    <div class="itinerary-list">
        <h3>Recorded Points ({{ points.length }})</h3>

        <div class="list-container" *ngIf="points.length > 0; else noPoints">
            <div class="point-item" *ngFor="let point of points; let i = index">
                <div class="point-header">
                    <span class="point-number">#{{ point.id }}</span>
                    <span class="point-time">{{ point.timestamp | date:'HH:mm:ss' }}</span>
                </div>
                <div class="point-data">
                    <div class="point-coord">
                        <strong>üìç</strong> {{ point.latitude.toFixed(6) }}, {{ point.longitude.toFixed(6) }}
                    </div>
                    <div class="point-details">
                        <span class="detail-item">
                            <strong>üö¥</strong> {{ formatSpeed(point.speed) }}
                        </span>
                        <span class="detail-item">
                            <strong>‚õ∞Ô∏è</strong> {{ formatAltitude(point.altitude) }}
                        </span>

                    </div>
                </div>
            </div>
        </div>

        <ng-template #noPoints>
            <div class="empty-state">
                <span class="detail-item" *ngFor="let point of points; let i = index">
                    <strong>üì°</strong> {{ point.accuracy.toFixed(1) }}m
                </span>
                <p>No points recorded yet.</p>
                <p>{{ gpsAvailable ? 'Recording will start and stop automatically with movement' : 'GPS is not available
                    on this
                    device.' }}</p>
            </div>
        </ng-template>

        <div class="recording-status" [class.recording]="isRecording">
            <div class="status-indicator">
                <span class="status-dot" [class.active]="isRecording"></span>
                {{ getMovementStatus() }}
            </div>
            <div *ngIf="isRecording" class="recording-time">
                {{ formatDuration(recordingDuration) }}
            </div>
        </div>

        <!-- Detailed Stats (expandable section) -->
        <div class="detailed-stats" *ngIf="points.length > 0">
            <h4>Trip Summary</h4>
            <div class="stats-list">
                <div class="stats-row">
                    <span>Points Recorded:</span>
                    <span>{{ getTripStats().pointsRecorded }}</span>
                </div>
                <div class="stats-row">
                    <span>Recording Time:</span>
                    <span>{{ getTripStats().recordingTime }}</span>
                </div>
                <div class="stats-row">
                    <span>Max Speed:</span>
                    <span>{{ getTripStats().maxSpeed }}</span>
                </div>
                <div class="stats-row" *ngIf="isRecording">
                    <span>Current Trip:</span>
                    <span>{{ getTripStats().currentTripDistance }}</span>
                </div>
            </div>
        </div>

    </div>
</div>