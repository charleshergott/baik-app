<div class="flight-display" *ngIf="navigationData$ | async as navData">
    <!-- Main Navigation Data -->
    <div class="primary-nav">
        <div class="distance-display">
            <div class="distance-value">{{navData.distanceToNext | number:'1.1-1'}} NM</div>
        </div>

        <div class="waypoint-info">
            <div class="waypoint-name">{{navData.nextWaypoint?.name || 'No Waypoint'}}</div>
            <div class="bearing-eta">
                <div class="bearing">HDG {{navData.bearingToNext | number:'1.0-0'}}°</div>
                <div class="eta">
                    ETA:
                    <span *ngIf="navData.estimatedTimeToNext >= 0">
                        {{navData.estimatedTimeToNext | number:'1.0-0'}} min
                    </span>
                    <span *ngIf="navData.estimatedTimeToNext < 0" class="eta-na">
                        ---
                    </span>
                </div>
            </div>
            <div class="frequency" *ngIf="navData.nextWaypoint?.frequency">
                FREQ: {{navData.nextWaypoint?.frequency}}
            </div>
        </div>
    </div>

    <!-- Instruments Panel -->
    <div class="instruments-panel">
        <div class="navigation-instruments">
            <!-- Secondary Data -->
            <div class="secondary-data">
                <div class="data-item">
                    <div class="label">GROUND SPEED</div>
                    <div class="value">
                        <span *ngIf="navData.groundSpeed >= 10">
                            {{navData.groundSpeed | number:'1.0-0'}} kt
                        </span>
                        <span *ngIf="navData.groundSpeed < 10" class="speed-na">
                            --- kt
                        </span>
                    </div>
                </div>

                <!-- <div class="data-item" *ngIf="navData.currentPosition.altitude">
                    <div class="label">ALTITUDE</div>
                    <div class="value">{{navData.currentPosition.altitude | number:'1.0-0'}} ft</div>
                </div> -->

                <div class="data-item">
                    <div class="label">COORDINATES</div>
                    <div class="value small">
                        {{navData.currentPosition.latitude | number:'1.6-6'}}<br>
                        {{navData.currentPosition.longitude | number:'1.6-6'}}
                    </div>
                </div>
            </div>
        </div>

        <div class="chronometer-panel">
            <app-chronometer></app-chronometer>
        </div>
    </div>

    <!-- Control Button -->
    <div class="controls">
        <button class="next-waypoint-btn" (click)="advanceWaypoint()">
            NEXT WAYPOINT
        </button>
    </div>
</div>

<!-- No Navigation Data State -->
<div class="no-data" *ngIf="!(navigationData$ | async)">
    <h2>Waiting for GPS Signal...</h2>
    <div class="spinner"></div>
    <p>Make sure GPS is enabled and you have a clear view of the sky</p>
</div>

<!-- Alert Overlay -->
<div class="alert-overlay" *ngIf="activeAlert$ | async as alert">
    <div class="alert-content">
        <div class="alert-icon">⚠️</div>
        <h3>NAVIGATION ALERT</h3>
        <p class="alert-message">{{alert.message}}</p>
        <button class="dismiss-btn" (click)="dismissAlert()">ACKNOWLEDGE</button>
    </div>
</div>